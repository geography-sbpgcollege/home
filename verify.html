
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      :root {
        --primary: #2563eb;
        --primary-dark: #1e40af;
        --secondary: #059669;
        --secondary-dark: #047857;
        --accent: #7e22ce;
        --danger: #ef4444;
        --danger-dark: #dc2626;
        --gray-100: #f8fafc;
        --gray-200: #f1f5f9;
        --gray-300: #e2e8f0;
        --gray-400: #cbd5e1;
        --gray-500: #94a3b8;
        --gray-600: #64748b;
        --gray-700: #475569;
        --gray-800: #334155;
        --gray-900: #1e293b;
        --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
        --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.12);
        --radius-sm: 6px;
        --radius-md: 12px;
        --radius-lg: 16px;
        --radius-xl: 24px;
        --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }

      html {
        font-size: 100%;
        scroll-behavior: smooth;
      }

      body {
        font-family: var(--font-sans);
        line-height: 1.6;
        color: var(--gray-800);
        background-color: var(--gray-100);
        padding: clamp(12px, 4vw, 20px);
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .container {
        max-width: 1200px;
        width: 100%;
        margin: 0 auto;
        padding: clamp(20px, 5vw, 30px);
      }

      h1 {
        color: var(--primary);
        text-align: center;
        margin-bottom: clamp(20px, 4vw, 30px);
        font-size: clamp(1.75rem, 5vw, 2.5rem);
        font-weight: 700;
        line-height: 1.2;
      }

      h2 {
        color: var(--primary);
        margin: clamp(20px, 3vw, 25px) 0 clamp(10px, 2vw, 15px);
        font-size: clamp(1.5rem, 4vw, 2rem);
        font-weight: 600;
        line-height: 1.3;
      }

      h3 {
        color: var(--primary);
        margin: clamp(15px, 2.5vw, 20px) 0 clamp(8px, 1.5vw, 10px);
        font-size: clamp(1.2rem, 3vw, 1.4rem);
        font-weight: 600;
        line-height: 1.3;
      }

      .video-container {
        position: relative;
        padding-bottom: 56.25%;
        height: 0;
        overflow: hidden;
        margin: 25px 0;
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-lg);
      }

      .video-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border-radius: var(--radius-md);
        border: none;
      }

      .alert-box {
        background-color: #eff6ff;
        border-left: 5px solid var(--primary);
        padding: clamp(15px, 3vw, 20px) clamp(20px, 3vw, 25px);
        margin: clamp(20px, 3vw, 25px) 0;
        border-radius: var(--radius-sm);
        box-shadow: var(--shadow-md);
      }

      .alert-box.warning {
        background-color: #fffbeb;
        border-left-color: #f59e0b;
        box-shadow: 0 4px 12px rgba(245, 158, 11, 0.1);
      }

      .alert-box h3 {
        font-weight: 600;
        color: var(--primary);
        margin-bottom: 8px;
      }

      .alert-box.warning h3 {
        color: #d97706;
      }

      .install-table {
        width: 100%;
        border-collapse: collapse;
        margin: 30px 0;
        box-shadow: var(--shadow-md);
        border-radius: var(--radius-md);
        overflow: hidden;
      }

      .install-table th {
        background-color: var(--primary);
        color: white;
        text-align: left;
        padding: clamp(12px, 2vw, 16px) clamp(15px, 2.5vw, 20px);
        font-weight: 600;
        font-size: clamp(0.95rem, 2vw, 1.1rem);
      }

      .install-table td {
        padding: clamp(12px, 2vw, 16px) clamp(15px, 2.5vw, 20px);
        border-bottom: 1px solid var(--gray-300);
        font-size: clamp(0.9rem, 1.8vw, 1rem);
      }

      .install-table tr:last-child td {
        border-bottom: none;
      }

      .install-table tr:nth-child(even) {
        background-color: var(--gray-200);
      }

      .install-table tr:hover {
        background-color: var(--gray-300);
      }

      .step-number {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background-color: var(--primary);
        color: white;
        width: clamp(30px, 6vw, 36px);
        height: clamp(30px, 6vw, 36px);
        text-align: center;
        border-radius: 50%;
        margin-right: 12px;
        font-weight: bold;
        box-shadow: 0 3px 8px rgba(37, 99, 235, 0.2);
        flex-shrink: 0;
      }

      ul {
        padding-left: clamp(16px, 3vw, 20px);
        margin: 10px 0;
      }

      ul li {
        margin-bottom: 8px;
        font-size: clamp(0.95rem, 1.8vw, 1rem);
      }

      .btn {
        display: inline-block;
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        padding: clamp(12px, 2.5vw, 14px) clamp(20px, 4vw, 28px);
        margin: 10px 5px;
        border-radius: 50px;
        text-decoration: none;
        font-weight: 600;
        transition: transform 0.3s, box-shadow 0.3s;
        box-shadow: 0 6px 12px rgba(37, 99, 235, 0.25);
        border: none;
        cursor: pointer;
        text-align: center;
        font-size: clamp(0.9rem, 1.8vw, 1rem);
      }

      .btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 15px rgba(37, 99, 235, 0.35);
      }

      .btn:active {
        transform: translateY(1px);
      }

      .btn-secondary {
        background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
        box-shadow: 0 6px 12px rgba(5, 150, 105, 0.25);
      }

      .btn-secondary:hover {
        box-shadow: 0 8px 15px rgba(5, 150, 105, 0.35);
      }

      .btn-container {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        margin: 30px 0;
        gap: clamp(10px, 2vw, 15px);
      }

      .contact-section {
        background-color: #e0f2fe;
        padding: clamp(20px, 4vw, 30px);
        border-radius: var(--radius-md);
        text-align: center;
        margin: 40px 0 30px;
        box-shadow: var(--shadow-md);
      }

      .wrapper {
        background-color: white;
        padding: clamp(25px, 5vw, 50px);
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-lg);
        max-width: 650px;
        width: 100%;
        text-align: center;
        margin: 30px auto;
        font-family: 'Poppins', var(--font-sans);
      }

      .tagline {
        color: var(--gray-600);
        font-size: clamp(1rem, 2vw, 18px);
        margin-bottom: 30px;
        font-weight: 400;
      }

      .notice {
        color: var(--gray-600);
        font-size: clamp(0.9rem, 1.8vw, 15px);
        margin-bottom: 20px;
        background-color: var(--gray-200);
        padding: clamp(10px, 2vw, 14px) clamp(16px, 3vw, 22px);
        border-radius: var(--radius-md);
        display: inline-block;
        max-width: 100%;
        word-wrap: break-word;
      }

      .action-area {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin: 35px 0;
        align-items: center;
        width: 100%;
      }

      .btns-inline {
        display: flex;
        gap: clamp(10px, 2vw, 18px);
        width: 100%;
        justify-content: center;
        flex-wrap: wrap;
      }

      .btns-inline button {
        flex: 1;
        max-width: 280px;
        min-width: 160px;
      }

      button {
        font-weight: 600;
        font-size: clamp(0.95rem, 1.9vw, 16px);
        padding: clamp(12px, 2.5vw, 16px) clamp(20px, 4vw, 32px);
        border: none;
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: clamp(200px, 30vw, 280px);
        box-shadow: var(--shadow-md);
        width: 100%;
      }

      button:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
      }

      button:active {
        transform: translateY(1px);
      }

      .google-signin {
        background-color: white;
        color: #757575;
        border: 1px solid #dadce0;
        padding: clamp(8px, 1.5vw, 10px) clamp(16px, 3vw, 20px);
        font-size: clamp(0.85rem, 1.7vw, 14px);
        font-weight: 500;
        border-radius: var(--radius-sm);
        transition: box-shadow 0.3s;
      }

      .google-signin:hover {
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .google-signin img {
        width: clamp(16px, 3vw, 18px);
        height: clamp(16px, 3vw, 18px);
        margin-right: 8px;
      }

      .check-btn {
        background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
        color: white;
      }

      .sub-btn {
        background: linear-gradient(135deg, var(--danger), var(--danger-dark));
        color: white;
      }

      .file-btn {
        background: linear-gradient(135deg, var(--primary), var(--accent));
        color: white;
        font-weight: 700;
        font-size: clamp(1rem, 2vw, 18px);
        padding: clamp(14px, 2.8vw, 18px) clamp(24px, 4.5vw, 36px);
        border-radius: var(--radius-lg);
        min-width: clamp(200px, 50vw, 320px);
        position: relative;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        box-shadow: 0 10px 20px rgba(59, 130, 246, 0.25),
          0 6px 6px rgba(126, 34, 206, 0.1);
        width: 100%;
        max-width: 100%;
      }

      .file-btn:hover {
        transform: translateY(-5px) scale(1.02);
        box-shadow: 0 15px 30px rgba(59, 130, 246, 0.3),
          0 10px 10px rgba(126, 34, 206, 0.15);
      }

      .file-btn:active {
        transform: translateY(1px);
      }

      .file-btn i {
        margin-right: 12px;
        font-size: clamp(16px, 3vw, 20px);
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
        100% {
          transform: scale(1);
        }
      }

      .not-visible {
        display: none !important;
      }

      .dl-text {
        font-size: clamp(1.5rem, 3vw, 24px);
        font-weight: 700;
        background: linear-gradient(135deg, var(--primary), var(--accent));
        background-clip: text;
        -webkit-background-clip: text;
        color: transparent;
        margin-bottom: 20px;
        position: relative;
        display: inline-block;
        animation: fadeInUp 0.7s ease;
      }

      .dl-text::after {
        content: '';
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(135deg, var(--primary), var(--accent));
        border-radius: 2px;
        animation: slideIn 1s ease;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideIn {
        from {
          width: 0;
        }
        to {
          width: 100%;
        }
      }

      #connectionProgress {
        background-color: #ffffff;
        padding: clamp(15px, 3vw, 20px);
        margin: 30px 0;
        transition: all 0.5s ease;
        max-width: 100%;
        overflow: hidden;
        border: 1px solid var(--gray-300);
        border-radius: var(--radius-md);
      }

      .progress-message {
        color: var(--primary);
        font-weight: 600;
        margin: 0 0 20px 0;
        font-size: clamp(1rem, 2.2vw, 18px);
        text-align: center;
        position: relative;
        padding-bottom: 15px;
      }

      .progress-message:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: clamp(60px, 10vw, 80px);
        height: 3px;
        background: linear-gradient(90deg, var(--primary), var(--accent));
        border-radius: 2px;
      }

      .connection-step {
        display: flex;
        align-items: flex-start;
        margin: 0 0 clamp(15px, 3vw, 25px) 0;
        opacity: 0;
        transform: translateY(20px) scale(0.95);
        transition: all 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        position: relative;
        background: var(--gray-100);
        padding: clamp(12px, 2vw, 15px);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-sm);
      }

      .connection-step:last-child {
        margin-bottom: clamp(10px, 2vw, 15px);
      }

      .connection-step.visible {
        opacity: 1;
        transform: translateY(0) scale(1);
      }

      .step-indicator {
        width: clamp(24px, 5vw, 30px);
        height: clamp(24px, 5vw, 30px);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.5s ease;
        font-weight: 600;
        font-size: clamp(12px, 2.4vw, 14px);
        color: var(--gray-600);
        border: 2px solid #fff;
        margin-right: clamp(10px, 2vw, 15px);
        flex-shrink: 0;
      }

      .step-indicator.active {
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        transform: scale(1.2);
        box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
      }

      .step-indicator.complete {
        background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
        color: white;
        transform: scale(1.2);
        box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.2);
      }

      .step-indicator i {
        font-size: clamp(12px, 2.4vw, 14px);
      }

      .step-content {
        flex: 1;
      }

      .step-text {
        font-size: clamp(0.95rem, 1.9vw, 16px);
        font-weight: 500;
        color: var(--gray-600);
        display: flex;
        align-items: center;
        transition: all 0.3s ease;
      }

      .step-description {
        font-size: clamp(0.85rem, 1.7vw, 14px);
        color: var(--gray-500);
        margin-top: 5px;
        max-height: 0;
        overflow: hidden;
        opacity: 0;
        transition: all 0.4s ease;
      }

      .step-text.active {
        color: var(--primary);
        font-weight: 600;
      }

      .step-text.complete {
        color: var(--secondary);
        font-weight: 600;
      }

      .step-description.active {
        max-height: 100px;
        opacity: 1;
        margin-top: 5px;
      }

      .step-icon {
        margin-right: 10px;
        opacity: 0;
        transition: all 0.3s ease;
        transform: translateX(-10px);
        color: var(--primary);
        font-size: clamp(14px, 2.8vw, 18px);
      }

      .step-icon.visible {
        opacity: 1;
        transform: translateX(0);
      }

      .step-text.complete .step-icon {
        color: var(--secondary);
      }

      .progress-bar {
        height: clamp(4px, 1vw, 6px);
        background-color: var(--gray-300);
        border-radius: 3px;
        width: 100%;
        margin: 20px 0 30px;
        position: relative;
        overflow: hidden;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
      }

      .progress-fill {
        position: absolute;
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--accent));
        width: 0;
        border-radius: 3px;
        transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
      }

      .success-checkmark {
        width: clamp(60px, 10vw, 80px);
        height: clamp(60px, 10vw, 80px);
        margin: 20px auto;
        position: relative;
        display: none;
      }

      .success-checkmark.visible-checkmark {
        display: block;
        animation: checkmark-appear 0.6s ease forwards;
      }

      .success-checkmark .check-icon {
        width: 100%;
        height: 100%;
        position: relative;
        border-radius: 50%;
        box-sizing: content-box;
        border: 4px solid var(--secondary);
        background: #fff;
      }

      .success-checkmark .check-icon::before {
        top: 3px;
        left: -2px;
        width: 30px;
        transform-origin: 100% 50%;
        border-radius: 100px 0 0 100px;
      }

      .success-checkmark .check-icon::after {
        top: 0;
        left: 30px;
        width: 60px;
        transform-origin: 0 50%;
        border-radius: 0 100px 100px 0;
        animation: rotate-circle 4.25s ease-in;
      }

      .success-checkmark .check-icon::before,
      .success-checkmark .check-icon::after {
        content: '';
        height: 100px;
        position: absolute;
        background: #fff;
        transform: rotate(-45deg);
      }

      .success-checkmark .check-icon .icon-line {
        height: 5px;
        background-color: var(--secondary);
        display: block;
        border-radius: 2px;
        position: absolute;
        z-index: 10;
      }

      .success-checkmark .check-icon .icon-line.line-tip {
        top: 46px;
        left: 14px;
        width: 25px;
        transform: rotate(45deg);
        animation: icon-line-tip 0.75s;
      }

      .success-checkmark .check-icon .icon-line.line-long {
        top: 38px;
        right: 8px;
        width: 47px;
        transform: rotate(-45deg);
        animation: icon-line-long 0.75s;
      }

      .success-checkmark .check-icon .icon-circle {
        top: -4px;
        left: -4px;
        z-index: 10;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        position: absolute;
        box-sizing: content-box;
        border: 4px solid var(--secondary);
      }

      .success-checkmark .check-icon .icon-fix {
        top: 8px;
        width: 5px;
        left: 26px;
        z-index: 1;
        height: 85px;
        position: absolute;
        transform: rotate(-45deg);
        background-color: #fff;
      }

      @keyframes checkmark-appear {
        from {
          opacity: 0;
          transform: scale(0.5) rotate(-10deg);
        }
        to {
          opacity: 1;
          transform: scale(1) rotate(0deg);
        }
      }

      @keyframes rotate-circle {
        0% {
          transform: rotate(-45deg);
        }
        5% {
          transform: rotate(-45deg);
        }
        12% {
          transform: rotate(-405deg);
        }
        100% {
          transform: rotate(-405deg);
        }
      }

      @keyframes icon-line-tip {
        0% {
          width: 0;
          left: 1px;
          top: 19px;
        }
        54% {
          width: 0;
          left: 1px;
          top: 19px;
        }
        70% {
          width: 50px;
          left: -8px;
          top: 37px;
        }
        84% {
          width: 17px;
          left: 21px;
          top: 48px;
        }
        100% {
          width: 25px;
          left: 14px;
          top: 46px;
        }
      }

      @keyframes icon-line-long {
        0% {
          width: 0;
          right: 46px;
          top: 54px;
        }
        65% {
          width: 0;
          right: 46px;
          top: 54px;
        }
        84% {
          width: 55px;
          right: 0px;
          top: 35px;
        }
        100% {
          width: 47px;
          right: 8px;
          top: 38px;
        }
      }

      @media (max-width: 992px) {
        html {
          font-size: 95%;
        }
        .wrapper {
          padding: clamp(20px, 4vw, 40px);
        }
        .file-btn {
          width: 100%;
        }
      }

      @media (max-width: 768px) {
        html {
          font-size: 90%;
        }
        body {
          padding: 15px;
        }
        .container {
          padding: 15px;
        }
        .connection-step {
          margin-bottom: 15px;
        }
        .btns-inline {
          flex-direction: column;
        }
        .btns-inline button {
          max-width: 100%;
        }
        button {
          width: 100%;
          max-width: 100%;
        }
      }

      @media (max-width: 480px) {
        html {
          font-size: 85%;
        }
        .step-text {
          font-size: 14px;
        }
        .step-description {
          font-size: 12px;
        }
        .step-indicator {
          width: 22px;
          height: 22px;
          margin-right: 8px;
        }
        .connection-step {
          padding: 10px;
        }
        .progress-message {
          font-size: 16px;
        }
        .file-btn {
          font-size: 14px;
          padding: 12px 20px;
        }
        .wrapper {
          padding: 15px;
        }
      }

      @media (max-width: 360px) {
        html {
          font-size: 80%;
        }
        .step-text {
          font-size: 13px;
        }
        h1 {
          font-size: 1.5rem;
        }
        h2 {
          font-size: 1.3rem;
        }
        h3 {
          font-size: 1.1rem;
        }
        .step-indicator {
          width: 20px;
          height: 20px;
        }
      }

      @media (max-width: 320px) {
        .file-btn,
        button {
          padding: 10px 16px;
          font-size: 13px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Google Web App Installation Guide</h1>

      <div class="alert-box">
        <h3>What You'll Learn</h3>
        <p>
          In this quick guide, you'll learn how to install and configure a
          Google Web App using Google Sheets and Apps Script. Start automating
          your workflows in just a few steps.
        </p>
      </div>

      <h2>Watch the Video Tutorial</h2>
      <div class="video-container">
<iframe width="560" height="315" src="https://www.youtube.com/embed/065hZfZgVZs?si=X0tcnfvzth-iWysv" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
      </div>

      <h2>Quick Installation Steps</h2>

      <table class="install-table">
        <tr>
          <th width="15%">Step</th>
          <th>Instructions</th>
        </tr>
        <tr>
          <td><div class="step-number">1</div></td>
          <td>
            <strong>Open the Web App Link</strong>
            <p>
              Click the provided link to open the Google Sheet or landing page
              you'll be working with.
            </p>
          </td>
        </tr>
        <tr>
          <td><div class="step-number">2</div></td>
          <td>
            <strong>Make a Copy</strong>
            <p>
              Go to <strong>File &#8594; Make a copy</strong> to save a personal copy
              in your Google Drive.
            </p>
          </td>
        </tr>
        <tr>
          <td><div class="step-number">3</div></td>
          <td>
            <strong>Open Apps Script</strong>
            <p>
              Click <strong>Extensions &#8594; Apps Script</strong> from the menu in
              your newly copied Google Sheet.
            </p>
          </td>
        </tr>
        <tr>
          <td><div class="step-number">4</div></td>
          <td>
            <strong>Deploy</strong>
            <p>
              Click the blue <strong>Deploy</strong> button &#8594; 
              <strong>New deployment</strong> &#8594; Select <strong>Web app</strong>.
            </p>
          </td>
        </tr>
        <tr>
          <td><div class="step-number">5</div></td>
          <td>
            <strong>Adjust Settings</strong>
            <p>
              Under <strong>Execute as</strong>, select <strong>Me</strong>, and
              set <strong>Who has access</strong> to <strong>Anyone</strong> (or
              your preferred setting).
            </p>
          </td>
        </tr>
        <tr>
          <td><div class="step-number">6</div></td>
          <td>
            <strong>Authorize</strong>
            <p>
              Click <strong>Deploy</strong> and follow the prompts to authorize
              any required permissions.
            </p>
          </td>
        </tr>
        <tr>
          <td><div class="step-number">7</div></td>
          <td>
            <strong>Get URL & Test</strong>
            <p>
              Copy the generated Web App URL, open it in a new tab, and confirm
              your app is working as intended.
            </p>
          </td>
        </tr>
      </table>


      <center>
        <div
          style="
            text-align: left;
            max-width: 650px;
            margin: auto;
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
          "
        >
          <h2
            style="
              color: #2563eb;
              text-align: center;
              margin-bottom: 20px;
              font-size: 28px;
            "
          >
            Get Free Source Code
          </h2>
          <p style="font-size: 16px; line-height: 1.6; margin-bottom: 20px;">
            Sign in with Google to unlock the source code. Our system uses this
            sign-in to verify your YouTube subscription to
            <strong style="color: #ef4444;">@rameezimdad</strong>.
          </p>
          <ul style="padding-left: 20px; margin-bottom: 25px;">
            <li style="margin-bottom: 10px; font-size: 15px;">
              Please use the same Gmail account you subscribed with so our
              system can accurately verify your subscription.
            </li>
            <li style="margin-bottom: 10px; font-size: 15px;">
              If you subscribed with a different account, the verification will
              not be successful.
            </li>
            <li style="margin-bottom: 10px; font-size: 15px;">
              Only verified subscribers receive access to the source code.
            </li>
          </ul>
        </div>

        <h3>Watch How to Download</h3>
        <div class="video-container">
<iframe width="560" height="315" src="https://www.youtube.com/embed/HuBf9p8IuCs?si=TT0IMmpGcsgHVsbe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
      </center>

      <div class="wrapper">
        <h2>Verify & Download Google Sheet</h2>
        <p class="tagline">
          Please verify your channel subscription to get instant access to the
          Google Sheet.
        </p>

        <div class="action-area">
          <button
            id="authBtn"
            class="google-signin"
            onclick="handleAuthClick()"
          >
            <img alt="Google logo" src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"
            />
            <span>Sign in with Google</span>
          </button>

          <div class="btns-inline">
            <button
              id="checkBtn"
              class="check-btn not-visible"
              onclick="checkSubscription()"
            >
              Verify Subscription
            </button>
            <button
              id="subscribeBtn"
              class="sub-btn not-visible"
              onclick="openChannelPage()"
            >
              Subscribe Here
            </button>
          </div>

          <div id="statusMessage" class="notice not-visible"></div>

          <div id="connectionProgress" class="not-visible">
            <div class="progress-message">Processing your request...</div>

            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="connection-step" id="step1">
              <div class="step-indicator">1</div>
              <div class="step-content">
                <span class="step-text">
                  <i class="fas fa-link step-icon"></i>Connecting with Server...
                </span>
                <span class="step-description"
                  >Establishing a secure connection to verify your account.</span
                >
              </div>
            </div>

            <div class="connection-step" id="step2">
              <div class="step-indicator">2</div>
              <div class="step-content">
                <span class="step-text">
                  <i class="fas fa-check-circle step-icon"></i>Connection
                  successful
                </span>
                <span class="step-description"
                  >We have successfully linked to the verification server.</span
                >
              </div>
            </div>

            <div class="connection-step" id="step3">
              <div class="step-indicator">3</div>
              <div class="step-content">
                <span class="step-text">
                  <i class="fas fa-key step-icon"></i>Verifying authorization
                </span>
                <span class="step-description"
                  >Confirming permissions and subscription data.</span
                >
              </div>
            </div>

            <div class="connection-step" id="step4">
              <div class="step-indicator">4</div>
              <div class="step-content">
                <span class="step-text">
                  <i class="fas fa-file-alt step-icon"></i>Locating Google Sheet
                </span>
                <span class="step-description"
                  >Successfully found your Google Sheet source file.</span
                >
              </div>
            </div>

            <div class="connection-step" id="step5">
              <div class="step-indicator">5</div>
              <div class="step-content">
                <span class="step-text">
                  <i class="fas fa-shield-alt step-icon"></i>Permissions
                  verified
                </span>
                <span class="step-description"
                  >Your account meets the access criteria.</span
                >
              </div>
            </div>

            <div class="connection-step" id="step6">
              <div class="step-indicator">6</div>
              <div class="step-content">
                <span class="step-text">
                  <i class="fas fa-magic step-icon"></i>Generating download link
                </span>
                <span class="step-description"
                  >Creating a personalized link for your copy.</span
                >
              </div>
            </div>

            <div class="success-checkmark" id="successCheckmark">
              <div class="check-icon">
                <span class="icon-line line-tip"></span>
                <span class="icon-line line-long"></span>
                <div class="icon-circle"></div>
                <div class="icon-fix"></div>
              </div>
            </div>
          </div>

          <p id="downloadLinkText" class="dl-text not-visible">
            Your Google Sheet is Ready!
          </p>
          <button
            id="downloadBtn"
            class="file-btn not-visible"
            onclick="openScriptLink()"
          >
            <i class="fas fa-download"></i>Download Google Sheet
          </button>
        </div>
      </div>

      <div class="contact-section">
        <h2>Need a Custom Solution?</h2>
        <p>
          Our team delivers fully customized Google Web App solutions&#8212;perfectly
          tailored for your unique needs.
        </p>
        <div class="btn-container">
          <a class="btn" href="https://wa.me/923224083545" target="_blank">
            Contact Us for Custom Projects
          </a>
          <a class="btn btn-secondary" href="https://community.rameezscripts.com/" target="_blank">
            Join Our WhatsApp Community
          </a>
        </div>
      </div>
    </div>

    <script src="https://accounts.google.com/gsi/client"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      let subscribersData = [];
      let accessToken = null;
      let tokenClient;
      // Replace with your actual channel ID and relevant links
      const REQUIRED_CHANNEL_ID = 'UC8hFdgy15R0zyUWXzr4BwuQ';
      const CHANNEL_URL = 'https://www.youtube.com/@rameezimdad?sub_confirmation=1';
      const GOOGLE_SCRIPT_URL =5
        'https://script.google.com/macros/s/AKfycbz-IlRWeP6gXH-E5FgaoCpifCyGXiZIW21HxHAaGSQBdR9xng6LnALb_O4vNmOUtwneOA/exec';
      const PREDEFINED_ACCESS_CODE = 'Domain';

      function initializeGis() {
        try {
          tokenClient = google.accounts.oauth2.initTokenClient({
            client_id:
              '1068454459694-p20idjlk8ikvreg280vrc3ergmjbt9rq.apps.googleusercontent.com',
            scope: 'https://www.googleapis.com/auth/youtube.readonly',
            callback: (response) => {
              if (response.access_token) {
                accessToken = response.access_token;
                document.getElementById('authBtn').style.display = 'none';
                checkSubscription();
              } else {
                Swal.fire({
                  icon: 'error',
                  title: 'Authentication Failed',
                  text: 'We could not verify your Google credentials. Please try again.',
                  confirmButtonColor: '#dc2626',
                });
              }
            },
          });
        } catch (error) {
          console.error('Error initializing GIS:', error);
          Swal.fire({
            icon: 'error',
            title: 'Initialization Failed',
            text: `Error: ${error.message}`,
            confirmButtonColor: '#dc2626',
          });
          document
            .getElementById('checkBtn')
            .classList.remove('not-visible');
        }
      }

      function handleAuthClick() {
        if (!accessToken) {
          tokenClient.requestAccessToken();
        } else {
          checkSubscription();
        }
      }

      function openChannelPage() {
        window.open(CHANNEL_URL, '_blank');
      }

      function showConnectionProgress() {
        const progressContainer = document.getElementById('connectionProgress');
        progressContainer.classList.remove('not-visible');

        const progressFill = document.getElementById('progressFill');
        progressFill.style.width = '0%';

        const steps = [
          { id: 'step1', delay: 2500, fillPercentage: 15 },
          { id: 'step2', delay: 5000, fillPercentage: 30 },
          { id: 'step3', delay: 7500, fillPercentage: 45 },
          { id: 'step4', delay: 10000, fillPercentage: 60 },
          { id: 'step5', delay: 12500, fillPercentage: 75 },
          { id: 'step6', delay: 15000, fillPercentage: 100 },
        ];

        setTimeout(() => {
          progressFill.style.width = '5%';
        }, 100);

        steps.forEach((step, index) => {
          setTimeout(() => {
            progressFill.style.width = `${step.fillPercentage}%`;

            const stepElement = document.getElementById(step.id);
            const indicator = stepElement.querySelector('.step-indicator');
            const text = stepElement.querySelector('.step-text');
            const description = stepElement.querySelector('.step-description');
            const icon = stepElement.querySelector('.step-icon');

            stepElement.classList.add('visible');
            indicator.classList.add('active');
            text.classList.add('active');
            description.classList.add('active');
            icon.classList.add('visible');

            if (index > 0) {
              const prevStepElement = document.getElementById(
                steps[index - 1].id
              );
              const prevIndicator =
                prevStepElement.querySelector('.step-indicator');
              const prevText = prevStepElement.querySelector('.step-text');

              prevIndicator.classList.remove('active');
              prevIndicator.classList.add('complete');
              prevIndicator.innerHTML = '<i class="fas fa-check"></i>';
              prevText.classList.remove('active');
              prevText.classList.add('complete');
            }

            if (index === steps.length - 1) {
              setTimeout(() => {
                const lastIndicator = document.querySelector(
                  `#${step.id} .step-indicator`
                );
                const lastText = document.querySelector(
                  `#${step.id} .step-text`
                );

                lastIndicator.classList.remove('active');
                lastIndicator.classList.add('complete');
                lastIndicator.innerHTML = '<i class="fas fa-check"></i>';
                lastText.classList.remove('active');
                lastText.classList.add('complete');

                const successCheckmark =
                  document.getElementById('successCheckmark');
                successCheckmark.classList.add('visible-checkmark');

                setTimeout(() => {
                  document
                    .getElementById('downloadLinkText')
                    .classList.remove('not-visible');
                  document
                    .getElementById('downloadBtn')
                    .classList.remove('not-visible');
                }, 800);
              }, 800);
            }
          }, step.delay);
        });
      }

      function resetConnectionProgress() {
        const connectionProgress =
          document.getElementById('connectionProgress');
        connectionProgress.classList.add('not-visible');
        const progressFill = document.getElementById('progressFill');
        progressFill.style.width = '0%';

        const successCheckmark = document.getElementById('successCheckmark');
        successCheckmark.classList.remove('visible-checkmark');

        document.querySelectorAll('.connection-step').forEach((step) => {
          step.classList.remove('visible');
          const indicator = step.querySelector('.step-indicator');
          const text = step.querySelector('.step-text');
          const description = step.querySelector('.step-description');
          const icon = step.querySelector('.step-icon');

          indicator.classList.remove('active', 'complete');
          indicator.innerHTML = step.id.replace('step', '');
          text.classList.remove('active', 'complete');
          description.classList.remove('active');
          icon.classList.remove('visible');
        });
      }

      async function checkSubscription() {
        const downloadBtn = document.getElementById('downloadBtn');
        const downloadLinkText = document.getElementById('downloadLinkText');
        const subscribeBtn = document.getElementById('subscribeBtn');
        const statusMessage = document.getElementById('statusMessage');

        try {
          downloadBtn.classList.add('not-visible');
          downloadLinkText.classList.add('not-visible');
          subscribeBtn.classList.add('not-visible');
          statusMessage.classList.add('not-visible');

          resetConnectionProgress();

          Swal.fire({
            title: 'Verifying Your Subscription...',
            html: 'We are now checking your channel subscription status. Please wait.',
            allowOutsideClick: false,
            didOpen: () => {
              Swal.showLoading();
            },
          });

          const response = await fetch(
            'https://www.googleapis.com/youtube/v3/subscriptions?part=snippet&mine=true&maxResults=50',
            {
              headers: {
                Authorization: `Bearer ${accessToken}`,
                Accept: 'application/json',
              },
            }
          );

          if (!response.ok) {
            const error = await response.json();
            throw new Error(
              error.error.message || 'Failed to fetch subscriptions'
            );
          }

          const data = await response.json();
          subscribersData = (data.items || []).map((item) => ({
            channelTitle: item.snippet.title,
            channelId: item.snippet.resourceId.channelId,
            channelUrl: `https://www.youtube.com/channel/${item.snippet.resourceId.channelId}`,
            username: item.snippet.channelTitle,
          }));

          const isSubscribed = subscribersData.some(
            (subscriber) => subscriber.channelId === REQUIRED_CHANNEL_ID
          );

          Swal.close();

          if (isSubscribed) {
            Swal.fire({
              icon: 'success',
              title: 'Subscription Confirmed',
              text: 'Preparing your download link now...',
              timer: 1500,
              showConfirmButton: false,
            }).then(() => {
              showConnectionProgress();
            });

            // Optional server-side verification
            try {
              const verifyResponse = await fetch(
                `${GOOGLE_SCRIPT_URL}?action=validateSubscription&token=${accessToken}`,
                { method: 'GET' }
              );
              const verifyData = await verifyResponse.json();
              if (verifyData.status !== 'success') {
                console.warn(
                  'Server verification did not return success, but continuing.'
                );
              }
            } catch (verifyError) {
              console.warn(
                'Additional verification failed on the server side, continuing anyway.',
                verifyError
              );
            }
          } else {
            Swal.fire({
              icon: 'warning',
              title: 'Subscription Not Found',
              html: `
                We could not confirm your subscription to our channel.
                <br><br>
                Please ensure you are subscribed with the same account.
              `,
              confirmButtonText: 'Subscribe',
              confirmButtonColor: '#dc2626',
              showCancelButton: true,
              cancelButtonText: 'Cancel',
              cancelButtonColor: '#6b7280',
            }).then((result) => {
              if (result.isConfirmed) {
                window.open(CHANNEL_URL, '_blank');
              }
            });

            statusMessage.textContent =
              'Please subscribe with the same account used during sign-in to continue.';
            statusMessage.classList.remove('not-visible');
            subscribeBtn.classList.remove('not-visible');
            document.getElementById('checkBtn').classList.remove('not-visible');
          }
        } catch (error) {
          console.error('Error checking subscription:', error);
          Swal.fire({
            icon: 'error',
            title: 'Verification Error',
            text: `Subscription verification failed: ${error.message}. Please try signing in again.`,
            confirmButtonColor: '#dc2626',
          });
          statusMessage.textContent =
            'Error verifying your subscription. Please try again.';
          statusMessage.classList.remove('not-visible');
          document.getElementById('checkBtn').classList.remove('not-visible');
          document.getElementById('authBtn').style.display = 'block';
          accessToken = null;
        }
      }

      async function openScriptLink() {
        const downloadBtn = document.getElementById('downloadBtn');
        const downloadLinkText = document.getElementById('downloadLinkText');
        const statusMessage = document.getElementById('statusMessage');
        const subscribeBtn = document.getElementById('subscribeBtn');

        try {
          Swal.fire({
            title: 'Retrieving Your File...',
            html: 'We are generating a link to your Google Sheet. Please wait.',
            allowOutsideClick: false,
            didOpen: () => {
              Swal.showLoading();
            },
          });

          const response = await fetch(
            `${GOOGLE_SCRIPT_URL}?action=getSheetUrl&key=${encodeURIComponent(
              PREDEFINED_ACCESS_CODE
            )}`,
            { method: 'GET' }
          );

          const data = await response.json();

          if (data.status === 'success' && data.url) {
            Swal.fire({
              icon: 'success',
              title: 'Link Generated',
              text: 'Your sheet is ready. Opening now...',
              confirmButtonColor: '#2563eb',
            });
            window.open(data.url, '_blank');
          } else {
            Swal.fire({
              icon: 'error',
              title: 'Access Denied',
              html: `
                We could not generate the file link. Ensure you are subscribed with the verified account.
                <br><br>
                <a href="${CHANNEL_URL}" target="_blank" style="color: #dc2626; text-decoration: underline; font-weight: 500;">
                  Subscribe Here
                </a>
              `,
              confirmButtonText: 'Subscribe',
              confirmButtonColor: '#dc2626',
              showCancelButton: true,
              cancelButtonText: 'Cancel',
              cancelButtonColor: '#6b7280',
            }).then((result) => {
              if (result.isConfirmed) {
                window.open(CHANNEL_URL, '_blank');
              }
            });

            statusMessage.textContent =
              'Subscription or access verification failed. Please subscribe and verify again.';
            statusMessage.classList.remove('not-visible');
            subscribeBtn.classList.remove('not-visible');
            document.getElementById('checkBtn').classList.remove('not-visible');
            throw new Error(data.message || 'Invalid access code');
          }
        } catch (error) {
          console.error('Error fetching sheet:', error);
          Swal.fire({
            icon: 'error',
            title: 'Error',
            text: `Could not retrieve the Google Sheet. ${error.message}`,
            confirmButtonColor: '#dc2626',
          });
          downloadBtn.classList.add('not-visible');
          downloadLinkText.classList.add('not-visible');
        }
      }

      window.onload = initializeGis;
    </script>
  </body>
</html>
